Training set size: 45000
Validation set size: 5000
Starting training for 60 epochs
Device: cuda
Batch size: 128

Epoch 1/60
                                                                        
Train Loss: 1.3317, Val Metrics: {'loss': 1.0064517468214036, 'accuracy': 0.6462}
✓ Best model updated!

Epoch 2/60
Train Loss: 0.9185, Val Metrics: {'loss': 0.9382211208343506, 'accuracy': 0.6794}
✓ Best model updated!

Epoch 3/60
Train Loss: 0.7398, Val Metrics: {'loss': 0.7198201835155487, 'accuracy': 0.7526}
✓ Best model updated!

Epoch 4/60
Train Loss: 0.6389, Val Metrics: {'loss': 0.6366256304085255, 'accuracy': 0.7804}
✓ Best model updated!

Epoch 5/60
Train Loss: 0.5686, Val Metrics: {'loss': 0.5441077120602131, 'accuracy': 0.808}
✓ Best model updated!

Epoch 6/60
Train Loss: 0.5087, Val Metrics: {'loss': 0.5378240942955017, 'accuracy': 0.8154}
✓ Best model updated!

Epoch 7/60
Train Loss: 0.4648, Val Metrics: {'loss': 0.5179971531033516, 'accuracy': 0.8212}
✓ Best model updated!

Epoch 8/60
Train Loss: 0.4278, Val Metrics: {'loss': 0.48852641955018045, 'accuracy': 0.8302}
✓ Best model updated!

Epoch 9/60
Train Loss: 0.3932, Val Metrics: {'loss': 0.4937807783484459, 'accuracy': 0.8438}
✓ Best model updated!

Epoch 10/60
Train Loss: 0.3664, Val Metrics: {'loss': 0.47447590380907056, 'accuracy': 0.845}
✓ Best model updated!

Epoch 11/60
Train Loss: 0.3360, Val Metrics: {'loss': 0.4520113043487072, 'accuracy': 0.852}
✓ Best model updated!

Epoch 12/60
Train Loss: 0.3079, Val Metrics: {'loss': 0.4512693636119366, 'accuracy': 0.8504}
No improvement for 1 epochs

Epoch 13/60
Train Loss: 0.2801, Val Metrics: {'loss': 0.4480908773839474, 'accuracy': 0.8578}
✓ Best model updated!

Epoch 14/60
Train Loss: 0.2618, Val Metrics: {'loss': 0.4303030535578728, 'accuracy': 0.8584}
✓ Best model updated!

Epoch 15/60
Train Loss: 0.2468, Val Metrics: {'loss': 0.448575322329998, 'accuracy': 0.8568}
No improvement for 1 epochs

Epoch 16/60
Train Loss: 0.2246, Val Metrics: {'loss': 0.4625783048570156, 'accuracy': 0.8598}
✓ Best model updated!

Epoch 17/60
Train Loss: 0.2111, Val Metrics: {'loss': 0.45142361149191856, 'accuracy': 0.8626}
✓ Best model updated!

Epoch 18/60
Train Loss: 0.1903, Val Metrics: {'loss': 0.4264140471816063, 'accuracy': 0.8714}
✓ Best model updated!

Epoch 19/60
Train Loss: 0.1828, Val Metrics: {'loss': 0.46001298949122427, 'accuracy': 0.863}
No improvement for 1 epochs

Epoch 20/60
Train Loss: 0.1706, Val Metrics: {'loss': 0.4663780122995377, 'accuracy': 0.8668}
No improvement for 2 epochs

Epoch 21/60
Train Loss: 0.1587, Val Metrics: {'loss': 0.46961577162146567, 'accuracy': 0.865}
No improvement for 3 epochs

Epoch 22/60
Train Loss: 0.1491, Val Metrics: {'loss': 0.43637251332402227, 'accuracy': 0.8714}
No improvement for 4 epochs

Epoch 23/60
Train Loss: 0.1435, Val Metrics: {'loss': 0.45529448240995407, 'accuracy': 0.8636}
No improvement for 5 epochs

Epoch 24/60
Train Loss: 0.1307, Val Metrics: {'loss': 0.47806554958224295, 'accuracy': 0.8632}
No improvement for 6 epochs

Epoch 25/60
Train Loss: 0.1205, Val Metrics: {'loss': 0.4903220601379871, 'accuracy': 0.8626}
No improvement for 7 epochs

Epoch 26/60
Train Loss: 0.1188, Val Metrics: {'loss': 0.4727640740573406, 'accuracy': 0.8732}
✓ Best model updated!

Epoch 27/60
Train Loss: 0.1121, Val Metrics: {'loss': 0.5129094198346138, 'accuracy': 0.8666}
No improvement for 1 epochs

Epoch 28/60
Train Loss: 0.1089, Val Metrics: {'loss': 0.4778018742799759, 'accuracy': 0.8696}
No improvement for 2 epochs

Epoch 29/60
Train Loss: 0.1033, Val Metrics: {'loss': 0.4919131509959698, 'accuracy': 0.8696}
No improvement for 3 epochs

Epoch 30/60
Train Loss: 0.0967, Val Metrics: {'loss': 0.5001909889280796, 'accuracy': 0.8718}
No improvement for 4 epochs

Epoch 31/60
Train Loss: 0.0929, Val Metrics: {'loss': 0.4984950333833694, 'accuracy': 0.8784}
✓ Best model updated!

Epoch 32/60
Train Loss: 0.0896, Val Metrics: {'loss': 0.5111334227025509, 'accuracy': 0.8768}
No improvement for 1 epochs

Epoch 33/60
Train Loss: 0.0821, Val Metrics: {'loss': 0.4759345851838589, 'accuracy': 0.8798}
✓ Best model updated!

Epoch 34/60
Train Loss: 0.0812, Val Metrics: {'loss': 0.5090784102678299, 'accuracy': 0.8772}
No improvement for 1 epochs

Epoch 35/60
Train Loss: 0.0759, Val Metrics: {'loss': 0.528278037905693, 'accuracy': 0.8742}
No improvement for 2 epochs

Epoch 36/60
Train Loss: 0.0780, Val Metrics: {'loss': 0.5724864959716797, 'accuracy': 0.8694}
No improvement for 3 epochs

Epoch 37/60
Train Loss: 0.0737, Val Metrics: {'loss': 0.5881821393966675, 'accuracy': 0.869}
No improvement for 4 epochs

Epoch 38/60
Train Loss: 0.0710, Val Metrics: {'loss': 0.5238818760961295, 'accuracy': 0.879}
No improvement for 5 epochs

Epoch 39/60
Train Loss: 0.0688, Val Metrics: {'loss': 0.504540317505598, 'accuracy': 0.8792}
No improvement for 6 epochs

Epoch 40/60
Train Loss: 0.0633, Val Metrics: {'loss': 0.5256508368998766, 'accuracy': 0.8756}
No improvement for 7 epochs

Epoch 41/60
Train Loss: 0.0649, Val Metrics: {'loss': 0.5638179428875446, 'accuracy': 0.8748}
No improvement for 8 epochs

Epoch 42/60
Train Loss: 0.0671, Val Metrics: {'loss': 0.5437124028801918, 'accuracy': 0.872}
No improvement for 9 epochs

Epoch 43/60
Train Loss: 0.0585, Val Metrics: {'loss': 0.5760334253311157, 'accuracy': 0.8754}
No improvement for 10 epochs
Early stopping triggered after 43 epochs
Loading best model weights

Final Test Metrics: {'loss': 0.5124688133408751, 'accuracy': 0.8689}

--- Results Summary for depth 3 ---
Simple CNN Test Accuracy: 0.8017
Residual CNN Test Accuracy: 0.8689

==================================================
Testing depth 4
==================================================

--- Simple CNN (depth 4) ---
Parameters: 1,575,690
Training set size: 45000
Validation set size: 5000
