Training set size: 45000
Validation set size: 5000
Starting training for 60 epochs
Device: cuda
Batch size: 128

Epoch 1/60
                                                                        
Train Loss: 1.2906, Val Metrics: {'loss': 0.9815595239400864, 'accuracy': 0.6602}
✓ Best model updated!

Epoch 2/60
Train Loss: 0.9384, Val Metrics: {'loss': 0.8249935746192932, 'accuracy': 0.7074}
✓ Best model updated!

Epoch 3/60
Train Loss: 0.7885, Val Metrics: {'loss': 0.741050373017788, 'accuracy': 0.7398}
✓ Best model updated!

Epoch 4/60
Train Loss: 0.6906, Val Metrics: {'loss': 0.7119920410215854, 'accuracy': 0.7544}
✓ Best model updated!

Epoch 5/60
Train Loss: 0.6250, Val Metrics: {'loss': 0.652061314880848, 'accuracy': 0.7744}
✓ Best model updated!

Epoch 6/60
Train Loss: 0.5619, Val Metrics: {'loss': 0.6085944816470146, 'accuracy': 0.785}
✓ Best model updated!

Epoch 7/60
Train Loss: 0.5107, Val Metrics: {'loss': 0.6253278695046902, 'accuracy': 0.7806}
No improvement for 1 epochs

Epoch 8/60
Train Loss: 0.4720, Val Metrics: {'loss': 0.5882980704307557, 'accuracy': 0.802}
✓ Best model updated!

Epoch 9/60
Train Loss: 0.4309, Val Metrics: {'loss': 0.5837158001959324, 'accuracy': 0.8014}
No improvement for 1 epochs

Epoch 10/60
Train Loss: 0.4006, Val Metrics: {'loss': 0.5755814507603645, 'accuracy': 0.8038}
✓ Best model updated!

Epoch 11/60
Train Loss: 0.3674, Val Metrics: {'loss': 0.5999595575034619, 'accuracy': 0.808}
✓ Best model updated!

Epoch 12/60
Train Loss: 0.3350, Val Metrics: {'loss': 0.5902332872152328, 'accuracy': 0.8084}
✓ Best model updated!

Epoch 13/60
Train Loss: 0.3078, Val Metrics: {'loss': 0.5929675489664078, 'accuracy': 0.8046}
No improvement for 1 epochs

Epoch 14/60
Train Loss: 0.2914, Val Metrics: {'loss': 0.5612720668315887, 'accuracy': 0.8242}
✓ Best model updated!

Epoch 15/60
Train Loss: 0.2670, Val Metrics: {'loss': 0.5997350916266442, 'accuracy': 0.815}
No improvement for 1 epochs

Epoch 16/60
Train Loss: 0.2466, Val Metrics: {'loss': 0.593526528775692, 'accuracy': 0.8092}
No improvement for 2 epochs

Epoch 17/60
Train Loss: 0.2306, Val Metrics: {'loss': 0.5624012634158134, 'accuracy': 0.8258}
✓ Best model updated!

Epoch 18/60
Train Loss: 0.2126, Val Metrics: {'loss': 0.5744238324463368, 'accuracy': 0.8236}
No improvement for 1 epochs

Epoch 19/60
Train Loss: 0.1978, Val Metrics: {'loss': 0.6362933561205864, 'accuracy': 0.816}
No improvement for 2 epochs

Epoch 20/60
Train Loss: 0.1858, Val Metrics: {'loss': 0.6254474706947803, 'accuracy': 0.8218}
No improvement for 3 epochs

Epoch 21/60
Train Loss: 0.1709, Val Metrics: {'loss': 0.5869141146540642, 'accuracy': 0.8272}
✓ Best model updated!

Epoch 22/60
Train Loss: 0.1599, Val Metrics: {'loss': 0.6226077578961849, 'accuracy': 0.8204}
No improvement for 1 epochs

Epoch 23/60
Train Loss: 0.1492, Val Metrics: {'loss': 0.6102806158363819, 'accuracy': 0.8232}
No improvement for 2 epochs

Epoch 24/60
Train Loss: 0.1424, Val Metrics: {'loss': 0.6572292447090149, 'accuracy': 0.8212}
No improvement for 3 epochs

Epoch 25/60
Train Loss: 0.1320, Val Metrics: {'loss': 0.6932454511523247, 'accuracy': 0.8186}
No improvement for 4 epochs

Epoch 26/60
Train Loss: 0.1247, Val Metrics: {'loss': 0.6895255200564862, 'accuracy': 0.821}
No improvement for 5 epochs

Epoch 27/60
Train Loss: 0.1235, Val Metrics: {'loss': 0.6810984455049038, 'accuracy': 0.8268}
No improvement for 6 epochs

Epoch 28/60
Train Loss: 0.1147, Val Metrics: {'loss': 0.6524501100182534, 'accuracy': 0.8302}
✓ Best model updated!

Epoch 29/60
Train Loss: 0.1052, Val Metrics: {'loss': 0.712993535399437, 'accuracy': 0.8148}
No improvement for 1 epochs

Epoch 30/60
Train Loss: 0.1064, Val Metrics: {'loss': 0.712147717922926, 'accuracy': 0.8244}
No improvement for 2 epochs

Epoch 31/60
Train Loss: 0.1021, Val Metrics: {'loss': 0.6707790024578572, 'accuracy': 0.828}
No improvement for 3 epochs

Epoch 32/60
Train Loss: 0.0966, Val Metrics: {'loss': 0.68478724360466, 'accuracy': 0.8292}
No improvement for 4 epochs

Epoch 33/60
Train Loss: 0.0945, Val Metrics: {'loss': 0.6700675770640373, 'accuracy': 0.8332}
✓ Best model updated!

Epoch 34/60
Train Loss: 0.0855, Val Metrics: {'loss': 0.7344644472002984, 'accuracy': 0.814}
No improvement for 1 epochs

Epoch 35/60
Train Loss: 0.0884, Val Metrics: {'loss': 0.7372799724340439, 'accuracy': 0.821}
No improvement for 2 epochs

Epoch 36/60
Train Loss: 0.0844, Val Metrics: {'loss': 0.7324993528425694, 'accuracy': 0.8342}
✓ Best model updated!

Epoch 37/60
Train Loss: 0.0773, Val Metrics: {'loss': 0.7112623944878578, 'accuracy': 0.833}
No improvement for 1 epochs

Epoch 38/60
Train Loss: 0.0739, Val Metrics: {'loss': 0.7023977138102054, 'accuracy': 0.8348}
✓ Best model updated!

Epoch 39/60
Train Loss: 0.0665, Val Metrics: {'loss': 0.7008198834955692, 'accuracy': 0.8308}
No improvement for 1 epochs

Epoch 40/60
Train Loss: 0.0714, Val Metrics: {'loss': 0.7711474448442459, 'accuracy': 0.8182}
No improvement for 2 epochs

Epoch 41/60
Train Loss: 0.0684, Val Metrics: {'loss': 0.748998086154461, 'accuracy': 0.8296}
No improvement for 3 epochs

Epoch 42/60
Train Loss: 0.0684, Val Metrics: {'loss': 0.76216005012393, 'accuracy': 0.8324}
No improvement for 4 epochs

Epoch 43/60
Train Loss: 0.0690, Val Metrics: {'loss': 0.7752828001976013, 'accuracy': 0.8284}
No improvement for 5 epochs

Epoch 44/60
Train Loss: 0.0646, Val Metrics: {'loss': 0.770284877717495, 'accuracy': 0.8364}
✓ Best model updated!

Epoch 45/60
Train Loss: 0.0595, Val Metrics: {'loss': 0.775993748754263, 'accuracy': 0.8336}
No improvement for 1 epochs

Epoch 46/60
Train Loss: 0.0596, Val Metrics: {'loss': 0.7327813483774662, 'accuracy': 0.8296}
No improvement for 2 epochs

Epoch 47/60
Train Loss: 0.0563, Val Metrics: {'loss': 0.7277683220803738, 'accuracy': 0.8404}
✓ Best model updated!

Epoch 48/60
Train Loss: 0.0578, Val Metrics: {'loss': 0.7495987102389335, 'accuracy': 0.8312}
No improvement for 1 epochs

Epoch 49/60
Train Loss: 0.0548, Val Metrics: {'loss': 0.7748925656080246, 'accuracy': 0.8294}
No improvement for 2 epochs

Epoch 50/60
Train Loss: 0.0505, Val Metrics: {'loss': 0.7748885564506054, 'accuracy': 0.8296}
No improvement for 3 epochs

Epoch 51/60
Train Loss: 0.0568, Val Metrics: {'loss': 0.8025652743875981, 'accuracy': 0.8268}
No improvement for 4 epochs

Epoch 52/60
Train Loss: 0.0516, Val Metrics: {'loss': 0.7801993191242218, 'accuracy': 0.83}
No improvement for 5 epochs

Epoch 53/60
Train Loss: 0.0439, Val Metrics: {'loss': 0.795104005932808, 'accuracy': 0.826}
No improvement for 6 epochs

Epoch 54/60
Train Loss: 0.0497, Val Metrics: {'loss': 0.7963456712663174, 'accuracy': 0.8314}
No improvement for 7 epochs

Epoch 55/60
Train Loss: 0.0487, Val Metrics: {'loss': 0.8034779071807862, 'accuracy': 0.8332}
No improvement for 8 epochs

Epoch 56/60
Train Loss: 0.0488, Val Metrics: {'loss': 0.7970431640744209, 'accuracy': 0.8342}
No improvement for 9 epochs

Epoch 57/60
Train Loss: 0.0446, Val Metrics: {'loss': 0.8125920720398426, 'accuracy': 0.83}
No improvement for 10 epochs
Early stopping triggered after 57 epochs
Loading best model weights

Final Test Metrics: {'loss': 0.7821102138561539, 'accuracy': 0.8287}

--- Residual CNN (depth 4) ---
Parameters: 11,156,778
Training set size: 45000
Validation set size: 5000
