Training set size: 45000
Validation set size: 5000
Starting training for 60 epochs
Device: cuda
Batch size: 128

Epoch 1/60
                                                                        
Train Loss: 1.4402, Val Metrics: {'loss': 1.1937713876366616, 'accuracy': 0.5732}
✓ Best model updated!

Epoch 2/60
Train Loss: 1.1305, Val Metrics: {'loss': 1.0113606810569764, 'accuracy': 0.6328}
✓ Best model updated!

Epoch 3/60
Train Loss: 0.9929, Val Metrics: {'loss': 0.98191719353199, 'accuracy': 0.6522}
✓ Best model updated!

Epoch 4/60
Train Loss: 0.9100, Val Metrics: {'loss': 0.9221992462873458, 'accuracy': 0.6866}
✓ Best model updated!

Epoch 5/60
Train Loss: 0.8508, Val Metrics: {'loss': 0.8531674429774284, 'accuracy': 0.6956}
✓ Best model updated!

Epoch 6/60
Train Loss: 0.8004, Val Metrics: {'loss': 0.8014878958463669, 'accuracy': 0.7234}
✓ Best model updated!

Epoch 7/60
Train Loss: 0.7529, Val Metrics: {'loss': 0.779918085038662, 'accuracy': 0.7218}
No improvement for 1 epochs

Epoch 8/60
Train Loss: 0.7214, Val Metrics: {'loss': 0.7484267219901085, 'accuracy': 0.74}
✓ Best model updated!

Epoch 9/60
Train Loss: 0.6817, Val Metrics: {'loss': 0.7207841664552689, 'accuracy': 0.7462}
✓ Best model updated!

Epoch 10/60
Train Loss: 0.6673, Val Metrics: {'loss': 0.8187908679246902, 'accuracy': 0.7188}
No improvement for 1 epochs

Epoch 11/60
Train Loss: 0.6334, Val Metrics: {'loss': 0.6805840134620667, 'accuracy': 0.7622}
✓ Best model updated!

Epoch 12/60
Train Loss: 0.6152, Val Metrics: {'loss': 0.767192468047142, 'accuracy': 0.7342}
No improvement for 1 epochs

Epoch 13/60
Train Loss: 0.5944, Val Metrics: {'loss': 0.7290473714470863, 'accuracy': 0.7464}
No improvement for 2 epochs

Epoch 14/60
Train Loss: 0.5694, Val Metrics: {'loss': 0.6422360718250275, 'accuracy': 0.771}
✓ Best model updated!

Epoch 15/60
Train Loss: 0.5533, Val Metrics: {'loss': 0.6664131470024586, 'accuracy': 0.7662}
No improvement for 1 epochs

Epoch 16/60
Train Loss: 0.5432, Val Metrics: {'loss': 0.6286830261349678, 'accuracy': 0.7752}
✓ Best model updated!

Epoch 17/60
Train Loss: 0.5223, Val Metrics: {'loss': 0.6585647173225879, 'accuracy': 0.7684}
No improvement for 1 epochs

Epoch 18/60
Train Loss: 0.5104, Val Metrics: {'loss': 0.6170156836509705, 'accuracy': 0.7882}
✓ Best model updated!

Epoch 19/60
Train Loss: 0.4960, Val Metrics: {'loss': 0.5955855451524258, 'accuracy': 0.7964}
✓ Best model updated!

Epoch 20/60
Train Loss: 0.4898, Val Metrics: {'loss': 0.5895023457705975, 'accuracy': 0.7964}
No improvement for 1 epochs

Epoch 21/60
Train Loss: 0.4711, Val Metrics: {'loss': 0.6016382575035095, 'accuracy': 0.7854}
No improvement for 2 epochs

Epoch 22/60
Train Loss: 0.4553, Val Metrics: {'loss': 0.606011176854372, 'accuracy': 0.7956}
No improvement for 3 epochs

Epoch 23/60
Train Loss: 0.4482, Val Metrics: {'loss': 0.6313926551491023, 'accuracy': 0.7756}
No improvement for 4 epochs

Epoch 24/60
Train Loss: 0.4327, Val Metrics: {'loss': 0.578296223282814, 'accuracy': 0.8032}
✓ Best model updated!

Epoch 25/60
Train Loss: 0.4242, Val Metrics: {'loss': 0.5874105535447598, 'accuracy': 0.7988}
No improvement for 1 epochs

Epoch 26/60
Train Loss: 0.4155, Val Metrics: {'loss': 0.5767645098268985, 'accuracy': 0.7994}
No improvement for 2 epochs

Epoch 27/60
Train Loss: 0.4033, Val Metrics: {'loss': 0.6010250106453896, 'accuracy': 0.795}
No improvement for 3 epochs

Epoch 28/60
Train Loss: 0.3986, Val Metrics: {'loss': 0.5934831209480762, 'accuracy': 0.7962}
No improvement for 4 epochs

Epoch 29/60
Train Loss: 0.3878, Val Metrics: {'loss': 0.5827689304947853, 'accuracy': 0.798}
No improvement for 5 epochs

Epoch 30/60
Train Loss: 0.3822, Val Metrics: {'loss': 0.5759344361722469, 'accuracy': 0.805}
✓ Best model updated!

Epoch 31/60
Train Loss: 0.3731, Val Metrics: {'loss': 0.5753970172256231, 'accuracy': 0.8052}
✓ Best model updated!

Epoch 32/60
Train Loss: 0.3666, Val Metrics: {'loss': 0.5883774846792221, 'accuracy': 0.8062}
✓ Best model updated!

Epoch 33/60
Train Loss: 0.3535, Val Metrics: {'loss': 0.5551754496991634, 'accuracy': 0.8102}
✓ Best model updated!

Epoch 34/60
Train Loss: 0.3492, Val Metrics: {'loss': 0.5897732377052307, 'accuracy': 0.8028}
No improvement for 1 epochs

Epoch 35/60
Train Loss: 0.3353, Val Metrics: {'loss': 0.5733407437801361, 'accuracy': 0.8036}
No improvement for 2 epochs

Epoch 36/60
Train Loss: 0.3356, Val Metrics: {'loss': 0.5886883325874805, 'accuracy': 0.8028}
No improvement for 3 epochs

Epoch 37/60
Train Loss: 0.3258, Val Metrics: {'loss': 0.6142764031887055, 'accuracy': 0.7924}
No improvement for 4 epochs

Epoch 38/60
Train Loss: 0.3164, Val Metrics: {'loss': 0.583819480240345, 'accuracy': 0.7994}
No improvement for 5 epochs

Epoch 39/60
Train Loss: 0.3150, Val Metrics: {'loss': 0.5580863080918789, 'accuracy': 0.8096}
No improvement for 6 epochs

Epoch 40/60
Train Loss: 0.3083, Val Metrics: {'loss': 0.5757055677473545, 'accuracy': 0.8044}
No improvement for 7 epochs

Epoch 41/60
Train Loss: 0.2987, Val Metrics: {'loss': 0.5848473228514195, 'accuracy': 0.8094}
No improvement for 8 epochs

Epoch 42/60
Train Loss: 0.2969, Val Metrics: {'loss': 0.5679792739450932, 'accuracy': 0.8138}
✓ Best model updated!

Epoch 43/60
Train Loss: 0.2877, Val Metrics: {'loss': 0.5799851551651954, 'accuracy': 0.8148}
✓ Best model updated!

Epoch 44/60
Train Loss: 0.2849, Val Metrics: {'loss': 0.577469527721405, 'accuracy': 0.8064}
No improvement for 1 epochs

Epoch 45/60
Train Loss: 0.2808, Val Metrics: {'loss': 0.5765459835529327, 'accuracy': 0.8118}
No improvement for 2 epochs

Epoch 46/60
Train Loss: 0.2719, Val Metrics: {'loss': 0.6443487204611301, 'accuracy': 0.7966}
No improvement for 3 epochs

Epoch 47/60
Train Loss: 0.2707, Val Metrics: {'loss': 0.5698805056512356, 'accuracy': 0.8124}
No improvement for 4 epochs

Epoch 48/60
Train Loss: 0.2632, Val Metrics: {'loss': 0.5749424621462822, 'accuracy': 0.8136}
No improvement for 5 epochs

Epoch 49/60
Train Loss: 0.2588, Val Metrics: {'loss': 0.5786832414567471, 'accuracy': 0.8128}
No improvement for 6 epochs

Epoch 50/60
Train Loss: 0.2501, Val Metrics: {'loss': 0.6077178694307804, 'accuracy': 0.8036}
No improvement for 7 epochs

Epoch 51/60
Train Loss: 0.2545, Val Metrics: {'loss': 0.5995880134403706, 'accuracy': 0.8104}
No improvement for 8 epochs

Epoch 52/60
Train Loss: 0.2451, Val Metrics: {'loss': 0.5891492091119289, 'accuracy': 0.805}
No improvement for 9 epochs

Epoch 53/60
Train Loss: 0.2399, Val Metrics: {'loss': 0.6239637345075607, 'accuracy': 0.8048}
No improvement for 10 epochs
Early stopping triggered after 53 epochs
Loading best model weights

Final Test Metrics: {'loss': 0.6065031357958347, 'accuracy': 0.8017}

--- Residual CNN (depth 3) ---
Parameters: 2,760,490
Training set size: 45000
Validation set size: 5000
