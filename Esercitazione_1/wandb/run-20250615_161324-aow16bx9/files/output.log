Training set size: 45000
Validation set size: 5000
Starting training for 60 epochs
Device: cuda
Batch size: 128

Epoch 1/60
                                                                        
Train Loss: 1.6021, Val Metrics: {'loss': 1.3887433856725693, 'accuracy': 0.4954}
✓ Best model updated!

Epoch 2/60
Train Loss: 1.3295, Val Metrics: {'loss': 1.2472453862428665, 'accuracy': 0.5486}
✓ Best model updated!

Epoch 3/60
Train Loss: 1.2305, Val Metrics: {'loss': 1.1465083092451096, 'accuracy': 0.5856}
✓ Best model updated!

Epoch 4/60
Train Loss: 1.1686, Val Metrics: {'loss': 1.1492490649223328, 'accuracy': 0.5954}
✓ Best model updated!

Epoch 5/60
Train Loss: 1.1235, Val Metrics: {'loss': 1.0800395086407661, 'accuracy': 0.6202}
✓ Best model updated!

Epoch 6/60
Train Loss: 1.0867, Val Metrics: {'loss': 1.1623416155576707, 'accuracy': 0.5878}
No improvement for 1 epochs

Epoch 7/60
Train Loss: 1.0548, Val Metrics: {'loss': 1.054845353960991, 'accuracy': 0.631}
✓ Best model updated!

Epoch 8/60
Train Loss: 1.0256, Val Metrics: {'loss': 1.1937281265854836, 'accuracy': 0.5724}
No improvement for 1 epochs

Epoch 9/60
Train Loss: 1.0032, Val Metrics: {'loss': 1.0865588575601577, 'accuracy': 0.6228}
No improvement for 2 epochs

Epoch 10/60
Train Loss: 0.9879, Val Metrics: {'loss': 0.9826921224594116, 'accuracy': 0.6536}
✓ Best model updated!

Epoch 11/60
Train Loss: 0.9701, Val Metrics: {'loss': 1.0226813524961471, 'accuracy': 0.648}
No improvement for 1 epochs

Epoch 12/60
Train Loss: 0.9513, Val Metrics: {'loss': 1.0749361380934714, 'accuracy': 0.6272}
No improvement for 2 epochs

Epoch 13/60
Train Loss: 0.9397, Val Metrics: {'loss': 1.0198739930987357, 'accuracy': 0.6446}
No improvement for 3 epochs

Epoch 14/60
Train Loss: 0.9258, Val Metrics: {'loss': 0.9179527655243873, 'accuracy': 0.6766}
✓ Best model updated!

Epoch 15/60
Train Loss: 0.9112, Val Metrics: {'loss': 0.9201993510127068, 'accuracy': 0.673}
No improvement for 1 epochs

Epoch 16/60
Train Loss: 0.8973, Val Metrics: {'loss': 0.947035451233387, 'accuracy': 0.6602}
No improvement for 2 epochs

Epoch 17/60
Train Loss: 0.8856, Val Metrics: {'loss': 0.9236233815550804, 'accuracy': 0.6806}
✓ Best model updated!

Epoch 18/60
Train Loss: 0.8764, Val Metrics: {'loss': 0.9336195722222328, 'accuracy': 0.668}
No improvement for 1 epochs

Epoch 19/60
Train Loss: 0.8657, Val Metrics: {'loss': 0.867363665997982, 'accuracy': 0.6922}
✓ Best model updated!

Epoch 20/60
Train Loss: 0.8590, Val Metrics: {'loss': 0.8605629116296768, 'accuracy': 0.7014}
✓ Best model updated!

Epoch 21/60
Train Loss: 0.8453, Val Metrics: {'loss': 0.9379817754030227, 'accuracy': 0.668}
No improvement for 1 epochs

Epoch 22/60
Train Loss: 0.8392, Val Metrics: {'loss': 0.8598469004034996, 'accuracy': 0.703}
✓ Best model updated!

Epoch 23/60
Train Loss: 0.8266, Val Metrics: {'loss': 0.8445255100727082, 'accuracy': 0.703}
No improvement for 1 epochs

Epoch 24/60
Train Loss: 0.8203, Val Metrics: {'loss': 0.8835539728403091, 'accuracy': 0.6848}
No improvement for 2 epochs

Epoch 25/60
Train Loss: 0.8132, Val Metrics: {'loss': 0.9316759377717971, 'accuracy': 0.6786}
No improvement for 3 epochs

Epoch 26/60
Train Loss: 0.8067, Val Metrics: {'loss': 0.838852870464325, 'accuracy': 0.7002}
No improvement for 4 epochs

Epoch 27/60
Train Loss: 0.7998, Val Metrics: {'loss': 0.8810694813728333, 'accuracy': 0.6848}
No improvement for 5 epochs

Epoch 28/60
Train Loss: 0.7935, Val Metrics: {'loss': 0.8305004805326461, 'accuracy': 0.7028}
No improvement for 6 epochs

Epoch 29/60
Train Loss: 0.7875, Val Metrics: {'loss': 0.8547474458813668, 'accuracy': 0.7016}
No improvement for 7 epochs

Epoch 30/60
Train Loss: 0.7763, Val Metrics: {'loss': 0.8796075001358986, 'accuracy': 0.6928}
No improvement for 8 epochs

Epoch 31/60
Train Loss: 0.7733, Val Metrics: {'loss': 0.8142288073897361, 'accuracy': 0.7094}
✓ Best model updated!

Epoch 32/60
Train Loss: 0.7723, Val Metrics: {'loss': 0.8448003724217414, 'accuracy': 0.7084}
No improvement for 1 epochs

Epoch 33/60
Train Loss: 0.7653, Val Metrics: {'loss': 0.9111770406365395, 'accuracy': 0.6868}
No improvement for 2 epochs

Epoch 34/60
Train Loss: 0.7565, Val Metrics: {'loss': 0.78359454870224, 'accuracy': 0.719}
✓ Best model updated!

Epoch 35/60
Train Loss: 0.7483, Val Metrics: {'loss': 0.8260748133063316, 'accuracy': 0.7168}
No improvement for 1 epochs

Epoch 36/60
Train Loss: 0.7448, Val Metrics: {'loss': 0.8116698801517487, 'accuracy': 0.7134}
No improvement for 2 epochs

Epoch 37/60
Train Loss: 0.7353, Val Metrics: {'loss': 0.7737450882792473, 'accuracy': 0.7242}
✓ Best model updated!

Epoch 38/60
Train Loss: 0.7315, Val Metrics: {'loss': 0.8250002682209014, 'accuracy': 0.7118}
No improvement for 1 epochs

Epoch 39/60
Train Loss: 0.7297, Val Metrics: {'loss': 0.8295636594295501, 'accuracy': 0.7044}
No improvement for 2 epochs

Epoch 40/60
Train Loss: 0.7227, Val Metrics: {'loss': 0.8155091375112533, 'accuracy': 0.7132}
No improvement for 3 epochs

Epoch 41/60
Train Loss: 0.7198, Val Metrics: {'loss': 0.7754986479878425, 'accuracy': 0.7344}
✓ Best model updated!

Epoch 42/60
Train Loss: 0.7136, Val Metrics: {'loss': 0.7947770148515702, 'accuracy': 0.72}
No improvement for 1 epochs

Epoch 43/60
Train Loss: 0.7146, Val Metrics: {'loss': 0.7610349893569947, 'accuracy': 0.7364}
✓ Best model updated!

Epoch 44/60
Train Loss: 0.7104, Val Metrics: {'loss': 0.775085823237896, 'accuracy': 0.7314}
No improvement for 1 epochs

Epoch 45/60
Train Loss: 0.7011, Val Metrics: {'loss': 0.7604011878371238, 'accuracy': 0.733}
No improvement for 2 epochs

Epoch 46/60
Train Loss: 0.6996, Val Metrics: {'loss': 0.80074263215065, 'accuracy': 0.7232}
No improvement for 3 epochs

Epoch 47/60
Train Loss: 0.6944, Val Metrics: {'loss': 0.7906212121248245, 'accuracy': 0.726}
No improvement for 4 epochs

Epoch 48/60
Train Loss: 0.6929, Val Metrics: {'loss': 0.8042709842324257, 'accuracy': 0.7254}
No improvement for 5 epochs

Epoch 49/60
Train Loss: 0.6904, Val Metrics: {'loss': 0.8023735821247101, 'accuracy': 0.7162}
No improvement for 6 epochs

Epoch 50/60
Train Loss: 0.6824, Val Metrics: {'loss': 0.7717414438724518, 'accuracy': 0.7318}
No improvement for 7 epochs

Epoch 51/60
Train Loss: 0.6804, Val Metrics: {'loss': 0.788747988641262, 'accuracy': 0.7316}
No improvement for 8 epochs

Epoch 52/60
Train Loss: 0.6798, Val Metrics: {'loss': 0.7433167725801468, 'accuracy': 0.7406}
✓ Best model updated!

Epoch 53/60
Train Loss: 0.6732, Val Metrics: {'loss': 0.7174465626478195, 'accuracy': 0.749}
✓ Best model updated!

Epoch 54/60
Train Loss: 0.6717, Val Metrics: {'loss': 0.745022839307785, 'accuracy': 0.7358}
No improvement for 1 epochs

Epoch 55/60
Train Loss: 0.6645, Val Metrics: {'loss': 0.7248290330171585, 'accuracy': 0.7474}
No improvement for 2 epochs

Epoch 56/60
Train Loss: 0.6627, Val Metrics: {'loss': 0.7089554160833359, 'accuracy': 0.7464}
No improvement for 3 epochs

Epoch 57/60
Train Loss: 0.6622, Val Metrics: {'loss': 0.7163649886846543, 'accuracy': 0.7506}
✓ Best model updated!

Epoch 58/60
Train Loss: 0.6564, Val Metrics: {'loss': 0.7418554455041886, 'accuracy': 0.743}
No improvement for 1 epochs

Epoch 59/60
Train Loss: 0.6584, Val Metrics: {'loss': 0.7387529462575912, 'accuracy': 0.7436}
No improvement for 2 epochs

Epoch 60/60
Train Loss: 0.6484, Val Metrics: {'loss': 0.7492813527584076, 'accuracy': 0.7378}
No improvement for 3 epochs
Loading best model weights

Final Test Metrics: {'loss': 0.726726757574685, 'accuracy': 0.7503}

--- Residual CNN (depth 2) ---
Parameters: 659,498
Training set size: 45000
Validation set size: 5000
