Starting training for 15 epochs
Device: cuda
Batch size: 128

Epoch 1/15
                                                                        
Train Loss: 1.5315, Val Metrics: {'loss': 1.175500999391079, 'accuracy': 0.5778}
✓ Best model updated!

Epoch 2/15
Train Loss: 1.1828, Val Metrics: {'loss': 1.06889006793499, 'accuracy': 0.6238}
✓ Best model updated!

Epoch 3/15
Train Loss: 1.0136, Val Metrics: {'loss': 0.8535511389374733, 'accuracy': 0.702}
✓ Best model updated!

Epoch 4/15
Train Loss: 0.8990, Val Metrics: {'loss': 0.7925955548882484, 'accuracy': 0.721}
✓ Best model updated!

Epoch 5/15
Train Loss: 0.8171, Val Metrics: {'loss': 0.7062437057495117, 'accuracy': 0.752}
✓ Best model updated!

Epoch 6/15
Train Loss: 0.7592, Val Metrics: {'loss': 0.6501465953886509, 'accuracy': 0.7748}
✓ Best model updated!

Epoch 7/15
Train Loss: 0.7092, Val Metrics: {'loss': 0.6733429238200188, 'accuracy': 0.775}
✓ Best model updated!

Epoch 8/15
Train Loss: 0.6737, Val Metrics: {'loss': 0.6373867630958557, 'accuracy': 0.7792}
✓ Best model updated!

Epoch 9/15
Train Loss: 0.6339, Val Metrics: {'loss': 0.6248790949583054, 'accuracy': 0.789}
✓ Best model updated!

Epoch 10/15
Train Loss: 0.6096, Val Metrics: {'loss': 0.6835870429873466, 'accuracy': 0.7728}
No improvement for 1 epochs

Epoch 11/15
Train Loss: 0.5802, Val Metrics: {'loss': 0.636209887266159, 'accuracy': 0.7874}
No improvement for 2 epochs

Epoch 12/15
Train Loss: 0.5644, Val Metrics: {'loss': 0.5496383726596832, 'accuracy': 0.8162}
✓ Best model updated!

Epoch 13/15
Train Loss: 0.5384, Val Metrics: {'loss': 0.5424855068325997, 'accuracy': 0.812}
No improvement for 1 epochs

Epoch 14/15
Train Loss: 0.5199, Val Metrics: {'loss': 0.4950945541262627, 'accuracy': 0.8344}
✓ Best model updated!

Epoch 15/15
Train Loss: 0.5061, Val Metrics: {'loss': 0.548792190104723, 'accuracy': 0.815}
No improvement for 1 epochs
Loading best model weights

Final Test Metrics: {'loss': 0.5253179175189778, 'accuracy': 0.8223}

Teacher model test accuracy: 0.8223
Model saved to models/rescnn_ch16_d4_c10_teacher.pth
