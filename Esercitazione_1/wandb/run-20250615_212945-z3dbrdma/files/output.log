Model: mlp_in784_h128_64_out10_relu_drop01
Total parameters: 109,386
Starting training for 60 epochs
Device: cuda
Batch size: 256

Epoch 1/60
                                                                        
Train Loss: 1.0041, Val Metrics: {'loss': 0.283877811084191, 'accuracy': 0.9211666666666667}
✓ Best model updated!

Epoch 2/60
Train Loss: 0.4534, Val Metrics: {'loss': 0.19136854944129786, 'accuracy': 0.944}
✓ Best model updated!

Epoch 3/60
Train Loss: 0.3529, Val Metrics: {'loss': 0.14484552231927714, 'accuracy': 0.9586666666666667}
✓ Best model updated!

Epoch 4/60
Train Loss: 0.3067, Val Metrics: {'loss': 0.1233105780556798, 'accuracy': 0.9636666666666667}
✓ Best model updated!

Epoch 5/60
Train Loss: 0.2796, Val Metrics: {'loss': 0.11323679238557816, 'accuracy': 0.9645}
✓ Best model updated!

Epoch 6/60
Train Loss: 0.2571, Val Metrics: {'loss': 0.10848860116675496, 'accuracy': 0.9666666666666667}
✓ Best model updated!

Epoch 7/60
Train Loss: 0.2493, Val Metrics: {'loss': 0.10004485336442788, 'accuracy': 0.9695}
✓ Best model updated!

Epoch 8/60
Train Loss: 0.2352, Val Metrics: {'loss': 0.09454921819269657, 'accuracy': 0.972}
✓ Best model updated!

Epoch 9/60
Train Loss: 0.2246, Val Metrics: {'loss': 0.0859053924990197, 'accuracy': 0.975}
✓ Best model updated!

Epoch 10/60
Train Loss: 0.2123, Val Metrics: {'loss': 0.08175939104209344, 'accuracy': 0.9736666666666667}
No improvement for 1 epochs

Epoch 11/60
Train Loss: 0.2090, Val Metrics: {'loss': 0.08806309554105003, 'accuracy': 0.9736666666666667}
No improvement for 2 epochs

Epoch 12/60
Train Loss: 0.2055, Val Metrics: {'loss': 0.07534829092522462, 'accuracy': 0.9765}
✓ Best model updated!

Epoch 13/60
Train Loss: 0.2006, Val Metrics: {'loss': 0.07840908272191882, 'accuracy': 0.9736666666666667}
No improvement for 1 epochs

Epoch 14/60
Train Loss: 0.1924, Val Metrics: {'loss': 0.06963155216847856, 'accuracy': 0.9788333333333333}
✓ Best model updated!

Epoch 15/60
Train Loss: 0.1894, Val Metrics: {'loss': 0.06942652026191354, 'accuracy': 0.978}
No improvement for 1 epochs

Epoch 16/60
Train Loss: 0.1858, Val Metrics: {'loss': 0.06841223492907982, 'accuracy': 0.9785}
No improvement for 2 epochs

Epoch 17/60
Train Loss: 0.1825, Val Metrics: {'loss': 0.06776693587501843, 'accuracy': 0.9803333333333333}
✓ Best model updated!

Epoch 18/60
Train Loss: 0.1817, Val Metrics: {'loss': 0.06501909834332764, 'accuracy': 0.9818333333333333}
✓ Best model updated!

Epoch 19/60
Train Loss: 0.1765, Val Metrics: {'loss': 0.06673972075805068, 'accuracy': 0.9796666666666667}
No improvement for 1 epochs

Epoch 20/60
Train Loss: 0.1761, Val Metrics: {'loss': 0.06509776677315433, 'accuracy': 0.9795}
No improvement for 2 epochs

Epoch 21/60
Train Loss: 0.1731, Val Metrics: {'loss': 0.061809452871481575, 'accuracy': 0.9813333333333333}
No improvement for 3 epochs

Epoch 22/60
Train Loss: 0.1723, Val Metrics: {'loss': 0.06247488696438571, 'accuracy': 0.9816666666666667}
No improvement for 4 epochs

Epoch 23/60
Train Loss: 0.1701, Val Metrics: {'loss': 0.06243064751227697, 'accuracy': 0.9811666666666666}
No improvement for 5 epochs

Epoch 24/60
Train Loss: 0.1686, Val Metrics: {'loss': 0.06035067016879717, 'accuracy': 0.9821666666666666}
✓ Best model updated!

Epoch 25/60
Train Loss: 0.1651, Val Metrics: {'loss': 0.05949086618299285, 'accuracy': 0.9821666666666666}
No improvement for 1 epochs

Epoch 26/60
Train Loss: 0.1617, Val Metrics: {'loss': 0.06177684284436206, 'accuracy': 0.9811666666666666}
No improvement for 2 epochs

Epoch 27/60
Train Loss: 0.1639, Val Metrics: {'loss': 0.06279898077870409, 'accuracy': 0.9815}
No improvement for 3 epochs

Epoch 28/60
Train Loss: 0.1639, Val Metrics: {'loss': 0.05780048963303367, 'accuracy': 0.9826666666666667}
✓ Best model updated!

Epoch 29/60
Train Loss: 0.1559, Val Metrics: {'loss': 0.05858142386811475, 'accuracy': 0.9826666666666667}
No improvement for 1 epochs

Epoch 30/60
Train Loss: 0.1594, Val Metrics: {'loss': 0.057860500955333315, 'accuracy': 0.984}
✓ Best model updated!

Epoch 31/60
Train Loss: 0.1554, Val Metrics: {'loss': 0.058558029510701694, 'accuracy': 0.982}
No improvement for 1 epochs

Epoch 32/60
Train Loss: 0.1577, Val Metrics: {'loss': 0.057392639496053256, 'accuracy': 0.9836666666666667}
No improvement for 2 epochs

Epoch 33/60
Train Loss: 0.1532, Val Metrics: {'loss': 0.057689762519051634, 'accuracy': 0.9831666666666666}
No improvement for 3 epochs

Epoch 34/60
Train Loss: 0.1510, Val Metrics: {'loss': 0.06128699084122976, 'accuracy': 0.9818333333333333}
No improvement for 4 epochs

Epoch 35/60
Train Loss: 0.1515, Val Metrics: {'loss': 0.056019314642374717, 'accuracy': 0.984}
No improvement for 5 epochs

Epoch 36/60
Train Loss: 0.1543, Val Metrics: {'loss': 0.05880917112032572, 'accuracy': 0.9818333333333333}
No improvement for 6 epochs

Epoch 37/60
Train Loss: 0.1537, Val Metrics: {'loss': 0.05720941179121534, 'accuracy': 0.984}
No improvement for 7 epochs

Epoch 38/60
Train Loss: 0.1459, Val Metrics: {'loss': 0.061657265216733016, 'accuracy': 0.9818333333333333}
No improvement for 8 epochs

Epoch 39/60
Train Loss: 0.1538, Val Metrics: {'loss': 0.05619033620071908, 'accuracy': 0.9836666666666667}
No improvement for 9 epochs

Epoch 40/60
Train Loss: 0.1463, Val Metrics: {'loss': 0.05253999381481359, 'accuracy': 0.9853333333333333}
✓ Best model updated!

Epoch 41/60
Train Loss: 0.1503, Val Metrics: {'loss': 0.051250676779697336, 'accuracy': 0.9845}
No improvement for 1 epochs

Epoch 42/60
Train Loss: 0.1481, Val Metrics: {'loss': 0.050579772175600134, 'accuracy': 0.9853333333333333}
No improvement for 2 epochs

Epoch 43/60
Train Loss: 0.1488, Val Metrics: {'loss': 0.054341685958206654, 'accuracy': 0.984}
No improvement for 3 epochs

Epoch 44/60
Train Loss: 0.1457, Val Metrics: {'loss': 0.052250746016701065, 'accuracy': 0.9826666666666667}
No improvement for 4 epochs

Epoch 45/60
Train Loss: 0.1449, Val Metrics: {'loss': 0.05394216813147068, 'accuracy': 0.9828333333333333}
No improvement for 5 epochs

Epoch 46/60
Train Loss: 0.1431, Val Metrics: {'loss': 0.0537197309701393, 'accuracy': 0.9835}
No improvement for 6 epochs

Epoch 47/60
Train Loss: 0.1408, Val Metrics: {'loss': 0.05071649133848647, 'accuracy': 0.985}
No improvement for 7 epochs

Epoch 48/60
Train Loss: 0.1394, Val Metrics: {'loss': 0.049851591465994716, 'accuracy': 0.9851666666666666}
No improvement for 8 epochs

Epoch 49/60
Train Loss: 0.1423, Val Metrics: {'loss': 0.05226478849848112, 'accuracy': 0.9846666666666667}
No improvement for 9 epochs

Epoch 50/60
Train Loss: 0.1423, Val Metrics: {'loss': 0.04948837240226567, 'accuracy': 0.9841666666666666}
No improvement for 10 epochs
Early stopping triggered after 50 epochs
Loading best model weights

Final Test Metrics: {'loss': 0.04475065317965345, 'accuracy': 0.9852}

==================================================
Testing shallow architecture
==================================================

--- Standard MLP ---
Parameters: 109,386
Training set size: 54000
Validation set size: 6000
