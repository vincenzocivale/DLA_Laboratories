Starting training for 50 epochs
Device: cuda
Batch size: 256

Epoch 1/50
                                                                        
Train Loss: 0.9884, Val Metrics: {'loss': 0.2784228213131428, 'accuracy': 0.9266666666666666}
✓ Best model updated!

Epoch 2/50
Train Loss: 0.4590, Val Metrics: {'loss': 0.18761390075087547, 'accuracy': 0.9446666666666667}
✓ Best model updated!

Epoch 3/50
Train Loss: 0.3619, Val Metrics: {'loss': 0.1465963637456298, 'accuracy': 0.9585}
✓ Best model updated!

Epoch 4/50
Train Loss: 0.3150, Val Metrics: {'loss': 0.1256173054377238, 'accuracy': 0.9653333333333334}
✓ Best model updated!

Epoch 5/50
Train Loss: 0.2838, Val Metrics: {'loss': 0.11779215404142936, 'accuracy': 0.9646666666666667}
No improvement for 1 epochs

Epoch 6/50
Train Loss: 0.2631, Val Metrics: {'loss': 0.11070337363829215, 'accuracy': 0.9646666666666667}
No improvement for 2 epochs

Epoch 7/50
Train Loss: 0.2508, Val Metrics: {'loss': 0.10405134409666061, 'accuracy': 0.9675}
✓ Best model updated!

Epoch 8/50
Train Loss: 0.2398, Val Metrics: {'loss': 0.1015552404957513, 'accuracy': 0.968}
✓ Best model updated!

Epoch 9/50
Train Loss: 0.2280, Val Metrics: {'loss': 0.09035110877205928, 'accuracy': 0.9733333333333334}
✓ Best model updated!

Epoch 10/50
Train Loss: 0.2163, Val Metrics: {'loss': 0.08806540522103508, 'accuracy': 0.9723333333333334}
No improvement for 1 epochs

Epoch 11/50
Train Loss: 0.2112, Val Metrics: {'loss': 0.09051227057352662, 'accuracy': 0.9716666666666667}
No improvement for 2 epochs

Epoch 12/50
Train Loss: 0.2085, Val Metrics: {'loss': 0.08088869104782741, 'accuracy': 0.9748333333333333}
✓ Best model updated!

Epoch 13/50
Train Loss: 0.2014, Val Metrics: {'loss': 0.07754949294030666, 'accuracy': 0.9763333333333334}
✓ Best model updated!

Epoch 14/50
Train Loss: 0.1946, Val Metrics: {'loss': 0.0783221257540087, 'accuracy': 0.9761666666666666}
No improvement for 1 epochs

Epoch 15/50
Train Loss: 0.1943, Val Metrics: {'loss': 0.07773512694984674, 'accuracy': 0.9756666666666667}
No improvement for 2 epochs

Epoch 16/50
Train Loss: 0.1847, Val Metrics: {'loss': 0.07792478194460273, 'accuracy': 0.976}
No improvement for 3 epochs

Epoch 17/50
Train Loss: 0.1826, Val Metrics: {'loss': 0.07363063399679959, 'accuracy': 0.9773333333333334}
✓ Best model updated!

Epoch 18/50
Train Loss: 0.1827, Val Metrics: {'loss': 0.0705231490234534, 'accuracy': 0.979}
✓ Best model updated!

Epoch 19/50
Train Loss: 0.1754, Val Metrics: {'loss': 0.07063048550238211, 'accuracy': 0.9761666666666666}
No improvement for 1 epochs

Epoch 20/50
Train Loss: 0.1743, Val Metrics: {'loss': 0.06226464477367699, 'accuracy': 0.9803333333333333}
✓ Best model updated!

Epoch 21/50
Train Loss: 0.1750, Val Metrics: {'loss': 0.0668681589110444, 'accuracy': 0.9803333333333333}
No improvement for 1 epochs

Epoch 22/50
Train Loss: 0.1693, Val Metrics: {'loss': 0.06605054197522502, 'accuracy': 0.9781666666666666}
No improvement for 2 epochs

Epoch 23/50
Train Loss: 0.1697, Val Metrics: {'loss': 0.06860376669404407, 'accuracy': 0.9786666666666667}
No improvement for 3 epochs

Epoch 24/50
Train Loss: 0.1671, Val Metrics: {'loss': 0.06839973075936238, 'accuracy': 0.9786666666666667}
No improvement for 4 epochs

Epoch 25/50
Train Loss: 0.1632, Val Metrics: {'loss': 0.06286924037461479, 'accuracy': 0.98}
No improvement for 5 epochs

Epoch 26/50
Train Loss: 0.1620, Val Metrics: {'loss': 0.06783642549999058, 'accuracy': 0.9793333333333333}
No improvement for 6 epochs

Epoch 27/50
Train Loss: 0.1615, Val Metrics: {'loss': 0.06584896698283653, 'accuracy': 0.98}
No improvement for 7 epochs

Epoch 28/50
Train Loss: 0.1604, Val Metrics: {'loss': 0.06430311826989055, 'accuracy': 0.9785}
No improvement for 8 epochs
Early stopping triggered after 28 epochs
Loading best model weights

Final Test Metrics: {'loss': 0.0532955942384433, 'accuracy': 0.9817}

==================================================
Testing shallow architecture
==================================================

==================================================
Testing shallow architecture
==================================================

==================================================
Testing shallow architecture
==================================================

==================================================
Testing shallow architecture
==================================================

--- Residual MLP ---
Parameters: 238,794
Training set size: 54000
Validation set size: 6000
