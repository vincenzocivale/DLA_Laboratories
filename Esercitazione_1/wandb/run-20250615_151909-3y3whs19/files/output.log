Starting training for 50 epochs
Device: cuda
Batch size: 256

Epoch 1/50
                                                                        
Train Loss: 0.7804, Val Metrics: {'loss': 0.2187794242054224, 'accuracy': 0.9338333333333333}
✓ Best model updated!

Epoch 2/50
Train Loss: 0.3596, Val Metrics: {'loss': 0.14793614049752554, 'accuracy': 0.9545}
✓ Best model updated!

Epoch 3/50
Train Loss: 0.2936, Val Metrics: {'loss': 0.12294019541392724, 'accuracy': 0.9625}
✓ Best model updated!

Epoch 4/50
Train Loss: 0.2555, Val Metrics: {'loss': 0.11155662204449375, 'accuracy': 0.9656666666666667}
✓ Best model updated!

Epoch 5/50
Train Loss: 0.2312, Val Metrics: {'loss': 0.09467160841450095, 'accuracy': 0.9721666666666666}
✓ Best model updated!

Epoch 6/50
Train Loss: 0.2117, Val Metrics: {'loss': 0.09111734479665756, 'accuracy': 0.9701666666666666}
No improvement for 1 epochs

Epoch 7/50
Train Loss: 0.2047, Val Metrics: {'loss': 0.08415894691521923, 'accuracy': 0.9743333333333334}
✓ Best model updated!

Epoch 8/50
Train Loss: 0.1984, Val Metrics: {'loss': 0.07861369646464784, 'accuracy': 0.9756666666666667}
✓ Best model updated!

Epoch 9/50
Train Loss: 0.1839, Val Metrics: {'loss': 0.07526467662925522, 'accuracy': 0.9756666666666667}
No improvement for 1 epochs

Epoch 10/50
Train Loss: 0.1761, Val Metrics: {'loss': 0.06945708145697911, 'accuracy': 0.978}
✓ Best model updated!

Epoch 11/50
Train Loss: 0.1684, Val Metrics: {'loss': 0.07245657833603521, 'accuracy': 0.9781666666666666}
✓ Best model updated!

Epoch 12/50
Train Loss: 0.1690, Val Metrics: {'loss': 0.06304606841877103, 'accuracy': 0.9796666666666667}
✓ Best model updated!

Epoch 13/50
Train Loss: 0.1635, Val Metrics: {'loss': 0.06476658318812649, 'accuracy': 0.9796666666666667}
No improvement for 1 epochs

Epoch 14/50
Train Loss: 0.1575, Val Metrics: {'loss': 0.06094543713455399, 'accuracy': 0.9816666666666667}
✓ Best model updated!

Epoch 15/50
Train Loss: 0.1545, Val Metrics: {'loss': 0.06710295852584143, 'accuracy': 0.9783333333333334}
No improvement for 1 epochs

Epoch 16/50
Train Loss: 0.1502, Val Metrics: {'loss': 0.06509144123022755, 'accuracy': 0.9785}
No improvement for 2 epochs

Epoch 17/50
Train Loss: 0.1475, Val Metrics: {'loss': 0.06122206764606138, 'accuracy': 0.9813333333333333}
No improvement for 3 epochs

Epoch 18/50
Train Loss: 0.1518, Val Metrics: {'loss': 0.05932445009239018, 'accuracy': 0.983}
✓ Best model updated!

Epoch 19/50
Train Loss: 0.1463, Val Metrics: {'loss': 0.057154432870447636, 'accuracy': 0.9831666666666666}
✓ Best model updated!

Epoch 20/50
Train Loss: 0.1417, Val Metrics: {'loss': 0.0605959154975911, 'accuracy': 0.9815}
No improvement for 1 epochs

Epoch 21/50
Train Loss: 0.1445, Val Metrics: {'loss': 0.0560497569385916, 'accuracy': 0.9841666666666666}
✓ Best model updated!

Epoch 22/50
Train Loss: 0.1411, Val Metrics: {'loss': 0.05627993082938095, 'accuracy': 0.984}
No improvement for 1 epochs

Epoch 23/50
Train Loss: 0.1367, Val Metrics: {'loss': 0.05438648319492737, 'accuracy': 0.9836666666666667}
No improvement for 2 epochs

Epoch 24/50
Train Loss: 0.1381, Val Metrics: {'loss': 0.0561739158971856, 'accuracy': 0.984}
No improvement for 3 epochs

Epoch 25/50
Train Loss: 0.1337, Val Metrics: {'loss': 0.05115066061262041, 'accuracy': 0.9851666666666666}
✓ Best model updated!

Epoch 26/50
Train Loss: 0.1293, Val Metrics: {'loss': 0.056356225007524095, 'accuracy': 0.9813333333333333}
No improvement for 1 epochs

Epoch 27/50
Train Loss: 0.1286, Val Metrics: {'loss': 0.055215262807905674, 'accuracy': 0.9845}
No improvement for 2 epochs

Epoch 28/50
Train Loss: 0.1274, Val Metrics: {'loss': 0.05410534244341155, 'accuracy': 0.9843333333333333}
No improvement for 3 epochs

Epoch 29/50
Train Loss: 0.1273, Val Metrics: {'loss': 0.05058259998137752, 'accuracy': 0.9835}
No improvement for 4 epochs

Epoch 30/50
Train Loss: 0.1299, Val Metrics: {'loss': 0.045882322592660785, 'accuracy': 0.9873333333333333}
✓ Best model updated!

Epoch 31/50
Train Loss: 0.1234, Val Metrics: {'loss': 0.051038679045935474, 'accuracy': 0.9846666666666667}
No improvement for 1 epochs

Epoch 32/50
Train Loss: 0.1236, Val Metrics: {'loss': 0.04840054277641078, 'accuracy': 0.9865}
No improvement for 2 epochs

Epoch 33/50
Train Loss: 0.1218, Val Metrics: {'loss': 0.0512146238082399, 'accuracy': 0.9846666666666667}
No improvement for 3 epochs

Epoch 34/50
Train Loss: 0.1219, Val Metrics: {'loss': 0.047345554921776056, 'accuracy': 0.9843333333333333}
No improvement for 4 epochs

Epoch 35/50
Train Loss: 0.1215, Val Metrics: {'loss': 0.050210746082787715, 'accuracy': 0.9848333333333333}
No improvement for 5 epochs

Epoch 36/50
Train Loss: 0.1190, Val Metrics: {'loss': 0.04625576284403602, 'accuracy': 0.9846666666666667}
No improvement for 6 epochs

Epoch 37/50
Train Loss: 0.1219, Val Metrics: {'loss': 0.05002957074126849, 'accuracy': 0.986}
No improvement for 7 epochs

Epoch 38/50
Train Loss: 0.1168, Val Metrics: {'loss': 0.04828616286007067, 'accuracy': 0.9855}
No improvement for 8 epochs
Early stopping triggered after 38 epochs
Loading best model weights

Final Test Metrics: {'loss': 0.035716047623282066, 'accuracy': 0.9881}

--- Results Summary for shallow ---
Standard MLP Test Accuracy: 0.9835
Residual MLP Test Accuracy: 0.9881

==================================================
Testing medium architecture
==================================================

--- Standard MLP ---
Parameters: 115,306
Training set size: 54000
Validation set size: 6000
