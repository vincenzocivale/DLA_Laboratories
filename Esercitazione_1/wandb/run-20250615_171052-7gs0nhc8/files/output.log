Training set size: 45000
Validation set size: 5000
Starting training for 60 epochs
Device: cuda
Batch size: 128

Epoch 1/60
                                                                        
Train Loss: 1.3483, Val Metrics: {'loss': 1.0717785954475403, 'accuracy': 0.6124}
✓ Best model updated!

Epoch 2/60
Train Loss: 0.9320, Val Metrics: {'loss': 0.9132198542356491, 'accuracy': 0.6822}
✓ Best model updated!

Epoch 3/60
Train Loss: 0.7477, Val Metrics: {'loss': 0.8754234805703163, 'accuracy': 0.701}
✓ Best model updated!

Epoch 4/60
Train Loss: 0.6364, Val Metrics: {'loss': 0.6858046554028988, 'accuracy': 0.7674}
✓ Best model updated!

Epoch 5/60
Train Loss: 0.5636, Val Metrics: {'loss': 0.6009717203676701, 'accuracy': 0.796}
✓ Best model updated!

Epoch 6/60
Train Loss: 0.5006, Val Metrics: {'loss': 0.5322213195264339, 'accuracy': 0.8132}
✓ Best model updated!

Epoch 7/60
Train Loss: 0.4487, Val Metrics: {'loss': 0.5149017132818698, 'accuracy': 0.8232}
✓ Best model updated!

Epoch 8/60
Train Loss: 0.4083, Val Metrics: {'loss': 0.5162653177976608, 'accuracy': 0.8226}
No improvement for 1 epochs

Epoch 9/60
Train Loss: 0.3625, Val Metrics: {'loss': 0.4998182334005833, 'accuracy': 0.831}
✓ Best model updated!

Epoch 10/60
Train Loss: 0.3389, Val Metrics: {'loss': 0.507543732970953, 'accuracy': 0.8318}
✓ Best model updated!

Epoch 11/60
Train Loss: 0.3024, Val Metrics: {'loss': 0.4662771724164486, 'accuracy': 0.8476}
✓ Best model updated!

Epoch 12/60
Train Loss: 0.2726, Val Metrics: {'loss': 0.5121009115129709, 'accuracy': 0.8398}
No improvement for 1 epochs

Epoch 13/60
Train Loss: 0.2497, Val Metrics: {'loss': 0.4784152202308178, 'accuracy': 0.8472}
No improvement for 2 epochs

Epoch 14/60
Train Loss: 0.2225, Val Metrics: {'loss': 0.4924243658781052, 'accuracy': 0.8442}
No improvement for 3 epochs

Epoch 15/60
Train Loss: 0.2038, Val Metrics: {'loss': 0.5138257361948491, 'accuracy': 0.8468}
No improvement for 4 epochs

Epoch 16/60
Train Loss: 0.1900, Val Metrics: {'loss': 0.5124874852597714, 'accuracy': 0.853}
✓ Best model updated!

Epoch 17/60
Train Loss: 0.1727, Val Metrics: {'loss': 0.5385321572422981, 'accuracy': 0.8482}
No improvement for 1 epochs

Epoch 18/60
Train Loss: 0.1568, Val Metrics: {'loss': 0.5568747751414775, 'accuracy': 0.8536}
✓ Best model updated!

Epoch 19/60
Train Loss: 0.1406, Val Metrics: {'loss': 0.5275538329035043, 'accuracy': 0.8554}
✓ Best model updated!

Epoch 20/60
Train Loss: 0.1324, Val Metrics: {'loss': 0.5533949658274651, 'accuracy': 0.859}
✓ Best model updated!

Epoch 21/60
Train Loss: 0.1249, Val Metrics: {'loss': 0.5222544312477112, 'accuracy': 0.8606}
✓ Best model updated!

Epoch 22/60
Train Loss: 0.1132, Val Metrics: {'loss': 0.5288420028984546, 'accuracy': 0.8608}
✓ Best model updated!

Epoch 23/60
Train Loss: 0.1063, Val Metrics: {'loss': 0.5943357788026333, 'accuracy': 0.8522}
No improvement for 1 epochs

Epoch 24/60
Train Loss: 0.1068, Val Metrics: {'loss': 0.5497613072395324, 'accuracy': 0.8556}
No improvement for 2 epochs

Epoch 25/60
Train Loss: 0.0962, Val Metrics: {'loss': 0.5745248828083277, 'accuracy': 0.857}
No improvement for 3 epochs

Epoch 26/60
Train Loss: 0.0913, Val Metrics: {'loss': 0.5700112171471119, 'accuracy': 0.8652}
✓ Best model updated!

Epoch 27/60
Train Loss: 0.0835, Val Metrics: {'loss': 0.6179461985826492, 'accuracy': 0.8568}
No improvement for 1 epochs

Epoch 28/60
Train Loss: 0.0796, Val Metrics: {'loss': 0.6044519394636154, 'accuracy': 0.8612}
No improvement for 2 epochs

Epoch 29/60
Train Loss: 0.0803, Val Metrics: {'loss': 0.5959181882441044, 'accuracy': 0.858}
No improvement for 3 epochs

Epoch 30/60
Train Loss: 0.0763, Val Metrics: {'loss': 0.5936399471014738, 'accuracy': 0.866}
✓ Best model updated!

Epoch 31/60
Train Loss: 0.0745, Val Metrics: {'loss': 0.5945762827992439, 'accuracy': 0.8646}
No improvement for 1 epochs

Epoch 32/60
Train Loss: 0.0672, Val Metrics: {'loss': 0.5981509990990161, 'accuracy': 0.8646}
No improvement for 2 epochs

Epoch 33/60
Train Loss: 0.0660, Val Metrics: {'loss': 0.5864922866225243, 'accuracy': 0.8612}
No improvement for 3 epochs

Epoch 34/60
Train Loss: 0.0650, Val Metrics: {'loss': 0.5861826185137033, 'accuracy': 0.864}
No improvement for 4 epochs

Epoch 35/60
Train Loss: 0.0608, Val Metrics: {'loss': 0.6166686467826367, 'accuracy': 0.8706}
✓ Best model updated!

Epoch 36/60
Train Loss: 0.0615, Val Metrics: {'loss': 0.612044944614172, 'accuracy': 0.8658}
No improvement for 1 epochs

Epoch 37/60
Train Loss: 0.0574, Val Metrics: {'loss': 0.6770393669605255, 'accuracy': 0.8492}
No improvement for 2 epochs

Epoch 38/60
Train Loss: 0.0570, Val Metrics: {'loss': 0.6042832113802433, 'accuracy': 0.8696}
No improvement for 3 epochs

Epoch 39/60
Train Loss: 0.0646, Val Metrics: {'loss': 0.628955164551735, 'accuracy': 0.8552}
No improvement for 4 epochs

Epoch 40/60
Train Loss: 0.0515, Val Metrics: {'loss': 0.5812198534607887, 'accuracy': 0.8692}
No improvement for 5 epochs

Epoch 41/60
Train Loss: 0.0499, Val Metrics: {'loss': 0.6347782453522086, 'accuracy': 0.8596}
No improvement for 6 epochs

Epoch 42/60
Train Loss: 0.0457, Val Metrics: {'loss': 0.6263501975685358, 'accuracy': 0.8674}
No improvement for 7 epochs

Epoch 43/60
Train Loss: 0.0512, Val Metrics: {'loss': 0.6635172076523304, 'accuracy': 0.864}
No improvement for 8 epochs

Epoch 44/60
Train Loss: 0.0445, Val Metrics: {'loss': 0.6437022663652897, 'accuracy': 0.8724}
✓ Best model updated!

Epoch 45/60
Train Loss: 0.0478, Val Metrics: {'loss': 0.7027529761195183, 'accuracy': 0.8588}
No improvement for 1 epochs

Epoch 46/60
Train Loss: 0.0486, Val Metrics: {'loss': 0.669127332419157, 'accuracy': 0.8666}
No improvement for 2 epochs

Epoch 47/60
Train Loss: 0.0445, Val Metrics: {'loss': 0.6447117950767278, 'accuracy': 0.868}
No improvement for 3 epochs

Epoch 48/60
Train Loss: 0.0448, Val Metrics: {'loss': 0.6724987313151359, 'accuracy': 0.8616}
No improvement for 4 epochs

Epoch 49/60
Train Loss: 0.0416, Val Metrics: {'loss': 0.6312637284398079, 'accuracy': 0.8702}
No improvement for 5 epochs

Epoch 50/60
Train Loss: 0.0410, Val Metrics: {'loss': 0.6887393839657306, 'accuracy': 0.8666}
No improvement for 6 epochs

Epoch 51/60
Train Loss: 0.0440, Val Metrics: {'loss': 0.6580656163394452, 'accuracy': 0.8602}
No improvement for 7 epochs

Epoch 52/60
Train Loss: 0.0387, Val Metrics: {'loss': 0.6277111951261759, 'accuracy': 0.8678}
No improvement for 8 epochs

Epoch 53/60
Train Loss: 0.0367, Val Metrics: {'loss': 0.6627609804272652, 'accuracy': 0.8662}
No improvement for 9 epochs

Epoch 54/60
Train Loss: 0.0414, Val Metrics: {'loss': 0.6678657323122025, 'accuracy': 0.8642}
No improvement for 10 epochs
Early stopping triggered after 54 epochs
Loading best model weights

Final Test Metrics: {'loss': 0.7198086539401284, 'accuracy': 0.8576}

--- Results Summary for depth 4 ---
Simple CNN Test Accuracy: 0.8287
Residual CNN Test Accuracy: 0.8576
