Starting training for 50 epochs
Device: cuda
Batch size: 256

Epoch 1/50
                                                                        
Train Loss: 0.8479, Val Metrics: {'loss': 0.2315795278797547, 'accuracy': 0.9296666666666666}
✓ Best model updated!

Epoch 2/50
Train Loss: 0.3653, Val Metrics: {'loss': 0.16253915832688412, 'accuracy': 0.9508333333333333}
✓ Best model updated!

Epoch 3/50
Train Loss: 0.2853, Val Metrics: {'loss': 0.12626514521737894, 'accuracy': 0.9585}
✓ Best model updated!

Epoch 4/50
Train Loss: 0.2534, Val Metrics: {'loss': 0.11318403171996276, 'accuracy': 0.9676666666666667}
✓ Best model updated!

Epoch 5/50
Train Loss: 0.2228, Val Metrics: {'loss': 0.09948804198453824, 'accuracy': 0.9715}
✓ Best model updated!

Epoch 6/50
Train Loss: 0.2061, Val Metrics: {'loss': 0.08899067901074886, 'accuracy': 0.972}
✓ Best model updated!

Epoch 7/50
Train Loss: 0.1982, Val Metrics: {'loss': 0.08751757194598515, 'accuracy': 0.974}
✓ Best model updated!

Epoch 8/50
Train Loss: 0.1876, Val Metrics: {'loss': 0.09123275553186734, 'accuracy': 0.9706666666666667}
No improvement for 1 epochs

Epoch 9/50
Train Loss: 0.1758, Val Metrics: {'loss': 0.07664269519348939, 'accuracy': 0.977}
✓ Best model updated!

Epoch 10/50
Train Loss: 0.1674, Val Metrics: {'loss': 0.08096044324338436, 'accuracy': 0.9743333333333334}
No improvement for 1 epochs

Epoch 11/50
Train Loss: 0.1608, Val Metrics: {'loss': 0.08328603549549977, 'accuracy': 0.9718333333333333}
No improvement for 2 epochs

Epoch 12/50
Train Loss: 0.1625, Val Metrics: {'loss': 0.07703302521258593, 'accuracy': 0.9788333333333333}
✓ Best model updated!

Epoch 13/50
Train Loss: 0.1563, Val Metrics: {'loss': 0.07349982438609004, 'accuracy': 0.979}
✓ Best model updated!

Epoch 14/50
Train Loss: 0.1513, Val Metrics: {'loss': 0.06510068045463413, 'accuracy': 0.9811666666666666}
✓ Best model updated!

Epoch 15/50
Train Loss: 0.1473, Val Metrics: {'loss': 0.08168129685024421, 'accuracy': 0.9755}
No improvement for 1 epochs

Epoch 16/50
Train Loss: 0.1452, Val Metrics: {'loss': 0.06160222777786354, 'accuracy': 0.9805}
No improvement for 2 epochs

Epoch 17/50
Train Loss: 0.1391, Val Metrics: {'loss': 0.06419866896855335, 'accuracy': 0.9821666666666666}
✓ Best model updated!

Epoch 18/50
Train Loss: 0.1403, Val Metrics: {'loss': 0.062054542591795325, 'accuracy': 0.9825}
✓ Best model updated!

Epoch 19/50
Train Loss: 0.1341, Val Metrics: {'loss': 0.06262042249242465, 'accuracy': 0.9823333333333333}
No improvement for 1 epochs

Epoch 20/50
Train Loss: 0.1324, Val Metrics: {'loss': 0.05545755890974154, 'accuracy': 0.9835}
✓ Best model updated!

Epoch 21/50
Train Loss: 0.1337, Val Metrics: {'loss': 0.062142148070658244, 'accuracy': 0.9798333333333333}
No improvement for 1 epochs

Epoch 22/50
Train Loss: 0.1276, Val Metrics: {'loss': 0.060391878398756184, 'accuracy': 0.9816666666666667}
No improvement for 2 epochs

Epoch 23/50
Train Loss: 0.1273, Val Metrics: {'loss': 0.060954519702742495, 'accuracy': 0.981}
No improvement for 3 epochs

Epoch 24/50
Train Loss: 0.1244, Val Metrics: {'loss': 0.05881337181199342, 'accuracy': 0.983}
No improvement for 4 epochs

Epoch 25/50
Train Loss: 0.1225, Val Metrics: {'loss': 0.054756845735634364, 'accuracy': 0.9846666666666667}
✓ Best model updated!

Epoch 26/50
Train Loss: 0.1217, Val Metrics: {'loss': 0.05768271155344943, 'accuracy': 0.983}
No improvement for 1 epochs

Epoch 27/50
Train Loss: 0.1199, Val Metrics: {'loss': 0.054742129519581795, 'accuracy': 0.9826666666666667}
No improvement for 2 epochs

Epoch 28/50
Train Loss: 0.1188, Val Metrics: {'loss': 0.05550248951961597, 'accuracy': 0.9833333333333333}
No improvement for 3 epochs

Epoch 29/50
Train Loss: 0.1169, Val Metrics: {'loss': 0.05146544201609989, 'accuracy': 0.9851666666666666}
✓ Best model updated!

Epoch 30/50
Train Loss: 0.1158, Val Metrics: {'loss': 0.0521042951537917, 'accuracy': 0.9841666666666666}
No improvement for 1 epochs

Epoch 31/50
Train Loss: 0.1134, Val Metrics: {'loss': 0.0532316049017633, 'accuracy': 0.985}
No improvement for 2 epochs

Epoch 32/50
Train Loss: 0.1185, Val Metrics: {'loss': 0.05004099969907353, 'accuracy': 0.9856666666666667}
✓ Best model updated!

Epoch 33/50
Train Loss: 0.1129, Val Metrics: {'loss': 0.05447044010118892, 'accuracy': 0.9838333333333333}
No improvement for 1 epochs

Epoch 34/50
Train Loss: 0.1138, Val Metrics: {'loss': 0.05197303784855952, 'accuracy': 0.9856666666666667}
No improvement for 2 epochs

Epoch 35/50
Train Loss: 0.1084, Val Metrics: {'loss': 0.047477221194033824, 'accuracy': 0.9855}
No improvement for 3 epochs

Epoch 36/50
Train Loss: 0.1078, Val Metrics: {'loss': 0.047090180373440184, 'accuracy': 0.9871666666666666}
✓ Best model updated!

Epoch 37/50
Train Loss: 0.1097, Val Metrics: {'loss': 0.05061143869534135, 'accuracy': 0.9848333333333333}
No improvement for 1 epochs

Epoch 38/50
Train Loss: 0.1070, Val Metrics: {'loss': 0.048705059297693275, 'accuracy': 0.9861666666666666}
No improvement for 2 epochs

Epoch 39/50
Train Loss: 0.1073, Val Metrics: {'loss': 0.04911266447743401, 'accuracy': 0.9875}
✓ Best model updated!

Epoch 40/50
Train Loss: 0.1058, Val Metrics: {'loss': 0.050382562641364835, 'accuracy': 0.9856666666666667}
No improvement for 1 epochs

Epoch 41/50
Train Loss: 0.1042, Val Metrics: {'loss': 0.05786803849817564, 'accuracy': 0.9853333333333333}
No improvement for 2 epochs

Epoch 42/50
Train Loss: 0.1016, Val Metrics: {'loss': 0.045532529785608254, 'accuracy': 0.9868333333333333}
No improvement for 3 epochs

Epoch 43/50
Train Loss: 0.1056, Val Metrics: {'loss': 0.0457909198400254, 'accuracy': 0.9871666666666666}
No improvement for 4 epochs

Epoch 44/50
Train Loss: 0.1048, Val Metrics: {'loss': 0.0424861612652118, 'accuracy': 0.9868333333333333}
No improvement for 5 epochs

Epoch 45/50
Train Loss: 0.1021, Val Metrics: {'loss': 0.04430362176693355, 'accuracy': 0.9861666666666666}
No improvement for 6 epochs

Epoch 46/50
Train Loss: 0.0989, Val Metrics: {'loss': 0.04907131214470913, 'accuracy': 0.9866666666666667}
No improvement for 7 epochs

Epoch 47/50
Train Loss: 0.1007, Val Metrics: {'loss': 0.04363301598156492, 'accuracy': 0.9866666666666667}
No improvement for 8 epochs
Early stopping triggered after 47 epochs
Loading best model weights

Final Test Metrics: {'loss': 0.0425578865892021, 'accuracy': 0.9855}

--- Results Summary for deep ---
Residual MLP Test Accuracy: 0.9855
