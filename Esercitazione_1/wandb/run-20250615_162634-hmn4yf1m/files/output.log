Training set size: 45000
Validation set size: 5000
Starting training for 60 epochs
Device: cuda
Batch size: 128

Epoch 1/60
                                                                        
Train Loss: 1.3504, Val Metrics: {'loss': 1.0516583368182182, 'accuracy': 0.6234}
✓ Best model updated!

Epoch 2/60
Train Loss: 0.9605, Val Metrics: {'loss': 0.9335490643978119, 'accuracy': 0.6718}
✓ Best model updated!

Epoch 3/60
Train Loss: 0.7930, Val Metrics: {'loss': 0.7426643684506417, 'accuracy': 0.7382}
✓ Best model updated!

Epoch 4/60
Train Loss: 0.6907, Val Metrics: {'loss': 0.6271156504750252, 'accuracy': 0.7768}
✓ Best model updated!

Epoch 5/60
Train Loss: 0.6177, Val Metrics: {'loss': 0.5746817998588085, 'accuracy': 0.7982}
✓ Best model updated!

Epoch 6/60
Train Loss: 0.5600, Val Metrics: {'loss': 0.588060163706541, 'accuracy': 0.8}
✓ Best model updated!

Epoch 7/60
Train Loss: 0.5187, Val Metrics: {'loss': 0.5307919777929783, 'accuracy': 0.8156}
✓ Best model updated!

Epoch 8/60
Train Loss: 0.4809, Val Metrics: {'loss': 0.528728998452425, 'accuracy': 0.8168}
✓ Best model updated!

Epoch 9/60
Train Loss: 0.4513, Val Metrics: {'loss': 0.4532551787793636, 'accuracy': 0.843}
✓ Best model updated!

Epoch 10/60
Train Loss: 0.4280, Val Metrics: {'loss': 0.619783503562212, 'accuracy': 0.7978}
No improvement for 1 epochs

Epoch 11/60
Train Loss: 0.3985, Val Metrics: {'loss': 0.4613376833498478, 'accuracy': 0.8478}
✓ Best model updated!

Epoch 12/60
Train Loss: 0.3776, Val Metrics: {'loss': 0.5033364467322826, 'accuracy': 0.8312}
No improvement for 1 epochs

Epoch 13/60
Train Loss: 0.3566, Val Metrics: {'loss': 0.4474396623671055, 'accuracy': 0.8526}
✓ Best model updated!

Epoch 14/60
Train Loss: 0.3366, Val Metrics: {'loss': 0.44496558979153633, 'accuracy': 0.8458}
No improvement for 1 epochs

Epoch 15/60
Train Loss: 0.3202, Val Metrics: {'loss': 0.4065012089908123, 'accuracy': 0.8658}
✓ Best model updated!

Epoch 16/60
Train Loss: 0.3040, Val Metrics: {'loss': 0.4282762661576271, 'accuracy': 0.8558}
No improvement for 1 epochs

Epoch 17/60
Train Loss: 0.2896, Val Metrics: {'loss': 0.4025297090411186, 'accuracy': 0.8666}
✓ Best model updated!

Epoch 18/60
Train Loss: 0.2748, Val Metrics: {'loss': 0.43993542715907097, 'accuracy': 0.8614}
No improvement for 1 epochs

Epoch 19/60
Train Loss: 0.2654, Val Metrics: {'loss': 0.3961795222014189, 'accuracy': 0.8712}
✓ Best model updated!

Epoch 20/60
Train Loss: 0.2547, Val Metrics: {'loss': 0.4337058037519455, 'accuracy': 0.865}
No improvement for 1 epochs

Epoch 21/60
Train Loss: 0.2385, Val Metrics: {'loss': 0.4626880198717117, 'accuracy': 0.8522}
No improvement for 2 epochs

Epoch 22/60
Train Loss: 0.2306, Val Metrics: {'loss': 0.4528166830539703, 'accuracy': 0.8572}
No improvement for 3 epochs

Epoch 23/60
Train Loss: 0.2214, Val Metrics: {'loss': 0.40408179387450216, 'accuracy': 0.8708}
No improvement for 4 epochs

Epoch 24/60
Train Loss: 0.2072, Val Metrics: {'loss': 0.43568018488585947, 'accuracy': 0.864}
No improvement for 5 epochs

Epoch 25/60
Train Loss: 0.1988, Val Metrics: {'loss': 0.41428772211074827, 'accuracy': 0.8726}
✓ Best model updated!

Epoch 26/60
Train Loss: 0.1974, Val Metrics: {'loss': 0.43684277795255183, 'accuracy': 0.8678}
No improvement for 1 epochs

Epoch 27/60
Train Loss: 0.1833, Val Metrics: {'loss': 0.4372536577284336, 'accuracy': 0.8708}
No improvement for 2 epochs

Epoch 28/60
Train Loss: 0.1815, Val Metrics: {'loss': 0.41334758922457693, 'accuracy': 0.876}
✓ Best model updated!

Epoch 29/60
Train Loss: 0.1722, Val Metrics: {'loss': 0.4119881294667721, 'accuracy': 0.8778}
✓ Best model updated!

Epoch 30/60
Train Loss: 0.1658, Val Metrics: {'loss': 0.43483835868537424, 'accuracy': 0.8756}
No improvement for 1 epochs

Epoch 31/60
Train Loss: 0.1662, Val Metrics: {'loss': 0.42360617518424987, 'accuracy': 0.8782}
✓ Best model updated!

Epoch 32/60
Train Loss: 0.1544, Val Metrics: {'loss': 0.42067665569484236, 'accuracy': 0.882}
✓ Best model updated!

Epoch 33/60
Train Loss: 0.1511, Val Metrics: {'loss': 0.4140968546271324, 'accuracy': 0.8862}
✓ Best model updated!

Epoch 34/60
Train Loss: 0.1433, Val Metrics: {'loss': 0.4653843428939581, 'accuracy': 0.8768}
No improvement for 1 epochs

Epoch 35/60
Train Loss: 0.1386, Val Metrics: {'loss': 0.4273187112063169, 'accuracy': 0.8804}
No improvement for 2 epochs

Epoch 36/60
Train Loss: 0.1322, Val Metrics: {'loss': 0.45087904296815395, 'accuracy': 0.8796}
No improvement for 3 epochs

Epoch 37/60
Train Loss: 0.1302, Val Metrics: {'loss': 0.4784561302512884, 'accuracy': 0.8706}
No improvement for 4 epochs

Epoch 38/60
Train Loss: 0.1247, Val Metrics: {'loss': 0.44274281337857246, 'accuracy': 0.8798}
No improvement for 5 epochs

Epoch 39/60
Train Loss: 0.1212, Val Metrics: {'loss': 0.43841649368405344, 'accuracy': 0.8822}
No improvement for 6 epochs

Epoch 40/60
Train Loss: 0.1174, Val Metrics: {'loss': 0.44749806076288223, 'accuracy': 0.8828}
No improvement for 7 epochs

Epoch 41/60
Train Loss: 0.1106, Val Metrics: {'loss': 0.46649972200393675, 'accuracy': 0.8784}
No improvement for 8 epochs

Epoch 42/60
Train Loss: 0.1124, Val Metrics: {'loss': 0.4771490328013897, 'accuracy': 0.874}
No improvement for 9 epochs

Epoch 43/60
Train Loss: 0.1136, Val Metrics: {'loss': 0.4571064464747906, 'accuracy': 0.8792}
No improvement for 10 epochs
Early stopping triggered after 43 epochs
Loading best model weights

Final Test Metrics: {'loss': 0.4296252601131608, 'accuracy': 0.8745}

--- Results Summary for depth 2 ---
Simple CNN Test Accuracy: 0.7503
Residual CNN Test Accuracy: 0.8745

==================================================
Testing depth 3
==================================================

--- Simple CNN (depth 3) ---
Parameters: 391,946
Training set size: 45000
Validation set size: 5000
